<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»»å‹™é€²åº¦ç›£æ§ - è‡ªå‹•åŒæ­¥</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 10px; font-size: 2rem; }
        .sync-status { 
            text-align: center; 
            margin-bottom: 30px;
            font-size: 0.8rem;
            opacity: 0.7;
        }
        .stats { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
            gap: 15px; 
            margin-bottom: 30px;
        }
        .stat-card {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        .stat-number { font-size: 2.5rem; font-weight: bold; margin: 8px 0; }
        .stat-label { opacity: 0.8; font-size: 0.85rem; }
        .p0 { color: #ff6b6b; }
        .p1 { color: #ffa502; }
        .p2 { color: #2ed573; }
        .p3 { color: #7bed9f; }
        .running { color: #1e90ff; }
        .done { color: #2ed573; }
        .blocked { color: #ff6b6b; }
        .pending { color: #888; }
        .tasks {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
        }
        .task {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin: 8px 0;
            background: rgba(255,255,255,0.08);
            border-radius: 10px;
            border-left: 4px solid #666;
        }
        .task.p0 { border-left-color: #ff6b6b; }
        .task.p1 { border-left-color: #ffa502; }
        .task.p2 { border-left-color: #2ed573; }
        .task.p3 { border-left-color: #7bed9f; }
        .task-badge {
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-right: 10px;
        }
        .task-badge.p0 { background: #ff6b6b; }
        .task-badge.p1 { background: #ffa502; color: #000; }
        .task-badge.p2 { background: #2ed573; color: #000; }
        .task-badge.p3 { background: #7bed9f; color: #000; }
        .task-status {
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
        }
        .task-status.running { background: #1e90ff; }
        .task-status.done { background: #2ed573; color: #000; }
        .task-status.blocked { background: #ff6b6b; }
        .task-status.pending { background: #555; }
        .manual-list {
            margin-top: 30px;
            padding: 15px;
            background: rgba(255,165,0,0.1);
            border-radius: 10px;
            border-left: 4px solid #ffa502;
        }
        .manual-list h3 { color: #ffa502; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š ä»»å‹™é€²åº¦ç›£æ§</h1>
        <div class="sync-status" id="syncStatus">æ­£åœ¨åŒæ­¥...</div>
        
        <div class="stats" id="stats">
            <div class="stat-card">
                <div class="stat-label">ç·Šæ€¥ [P0]</div>
                <div class="stat-number p0" id="p0Count">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">é€²è¡Œä¸­</div>
                <div class="stat-number running" id="runningCount">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">å·²å®Œæˆ</div>
                <div class="stat-number done" id="doneCount">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">é˜»å¡</div>
                <div class="stat-number blocked" id="blockedCount">-</div>
            </div>
        </div>
        
        <div class="tasks" id="tasks">
            <h2>ğŸ“‹ ä»»å‹™åˆ—è¡¨</h2>
            <div id="taskList">è¼‰å…¥ä¸­...</div>
        </div>
        
        <div class="manual-list">
            <h3>âš ï¸ èªªæ˜</h3>
            <p>æ­¤å„€è¡¨æ¿æ¯ 60 ç§’è‡ªå‹•åŒæ­¥ BD ä»»å‹™ç‹€æ…‹ã€‚éœ€è¨­å®š API ä¼ºæœå™¨æ‰èƒ½è‡ªå‹•æŠ“å–ã€‚</p>
        </div>
    </div>
    
    <script>
        // éœæ…‹æ•¸æ“šï¼ˆé è¨­ï¼‰
        const defaultTasks = [
            {priority: 'P0', title: 'å»ºç«‹ä»»å‹™ç›£æ§å„€è¡¨æ¿', status: 'done'},
            {priority: 'P1', title: 'è¨­å®š BD API è‡ªå‹•åŒæ­¥', status: 'running'},
            {priority: 'P2', title: 'æ•´åˆ OpenClaw è¨˜æ†¶ç³»çµ±', status: 'done'},
            {priority: 'P2', title: 'è¨­å®š GitHub è‡ªå‹•åŒ–', status: 'done'},
            {priority: 'P3', title: 'å„ªåŒ– Sub-Agent æç¤ºè©', status: 'pending'},
        ];
        
        function renderTasks(tasks) {
            const p0 = tasks.filter(t => t.priority === 'P0').length;
            const running = tasks.filter(t => t.status === 'running').length;
            const done = tasks.filter(t => t.status === 'done').length;
            const blocked = tasks.filter(t => t.status === 'blocked').length;
            
            document.getElementById('p0Count').textContent = p0;
            document.getElementById('runningCount').textContent = running;
            document.getElementById('doneCount').textContent = done;
            document.getElementById('blockedCount').textContent = blocked;
            
            let html = '';
            tasks.forEach(t => {
                html += `<div class="task ${t.priority.toLowerCase()}">
                    <span>${t.title}</span>
                    <div>
                        <span class="task-badge ${t.priority.toLowerCase()}">${t.priority}</span>
                        <span class="task-status ${t.status}">${t.status}</span>
                    </div>
                </div>`;
            });
            document.getElementById('taskList').innerHTML = html || 'ç„¡ä»»å‹™';
        }
        
        // å˜—è©¦å¾ API ç²å–
        fetch('http://localhost:3456/api/tasks', {mode: 'cors'})
            .then(r => r.json())
            .then(data => {
                document.getElementById('syncStatus').textContent = 'âœ… å·²åŒæ­¥ ' + new Date().toLocaleTimeString('zh-TW');
                renderTasks(data.tasks || []);
            })
            .catch(e => {
                document.getElementById('syncStatus').textContent = 'âš ï¸ ä½¿ç”¨é è¨­æ•¸æ“š (' + new Date().toLocaleTimeString('zh-TW') + ')';
                renderTasks(defaultTasks);
            });
        
        // æ¯ 60 ç§’åˆ·æ–°
        setTimeout(() => location.reload(), 60000);
    </script>
</body>
</html>
